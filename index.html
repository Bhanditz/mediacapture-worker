<!DOCTYPE html>
<html>
  <head>
    <title>Media Capture Stream with Video Worker</title>
    <meta charset='utf-8'>
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common'
            async class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          // specification status (e.g. WD, LCWD, WG-NOTE, etc.). If in doubt use ED.
          specStatus:           "ED",

          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "mediacapture-worker",

          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          // subtitle   :  "an excellent document",

          // if you wish the publication date to be other than the last modification, set this
          // publishDate:  "2009-08-06",

          // if the specification's copyright date is a range of years, specify
          // the start date here:
          // copyrightStart: "2005"

          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          // previousPublishDate:  "1977-03-15",
          // previousMaturity:  "WD",

          // if there a publicly available Editor's Draft, this is the link
           edDraftURI:           "http://chiahungtai.github.io/mediacapture-worker/",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              {
                  name:       "Chia-hung Tai"
//              ,   url:        "http://example.org/"
              ,   mailto:     "ctai@mozilla.com"
              ,   company:    "Mozilla"
              ,   companyURL: "https://www.mozilla.org/en-US/foundation/moco/"
              },
              {
                  name:       "Robert O'Callahan"
//              ,   url:        "http://example.org/"
              ,   company:    "Mozilla"
              ,   companyURL: "https://www.mozilla.org/en-US/foundation/moco/"
              },
          ],

          // name of the WG
          wg:           "Web Real-Time Communication Working Group",

          // URI of the public WG page
          wgURI:        "http://www.w3.org/2011/04/webrtc/",

          // name (without the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "public-media-capture",

          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "",
          // !!!! IMPORTANT !!!! MAKE THE ABOVE BLINK IN YOUR HEAD
      };
    </script>
  </head>
  <body>
    <section id='abstract'>
      <p>
        This specification extends the <em>Media Capture and Streams</em>
        specification [[!GETUSERMEDIA]] to allow JavaScript developers for
        processing video frame data in workers in web applications.
      </p>
    </section>

    <section id='sotd'>
      <p>
        This document is not complete and is subject to change. Early
        experimentations are encouraged to allow the Media Capture Task Force
        to evolve the specification based on technical discussions within the
        Task Force, implementation experience gained from early
        implementations, and feedback from other groups and
        individuals.
      </p>
    </section>
    <section>
      <h2>Introduction</h2>
      <p>
        <em>Media Capture and Streams</em> provides a way to access to the video
        camera. But how to process the video frame data in JavaScript is not
        covered. By associating a worker with
        <a><code>MediaStreamTrack</code></a>s, we can dispatch
        <a><code>VideoProcessEvent</code></a> with each video frame to the
        worker which is connected to the particularly
        <a><code>MediaStreamTrack</code></a>. Then JavaScript developer can
        write a video processing script which enable processing, and analysis of
        video data directly using JavaScript in a Worker thread.
      </p>
    </section>
    <section>
      <h2>Use cases and requirements</h2>
      <p>
        Under Construction...
      </p>
    </section>
    <section>
      <h2>Conformance</h2>
      <p>
        Under Construction...
      </p>
    </section>
    <section>
      <h2>Dependencies</h2>
      <p>
        Under Construction...
      </p>
    </section>
    <section>
      <h2>Terminology</h2>
      <p>
        Under Construction...
      </p>
    </section>
    <section>
      <h2>Extensions</h2>
        <section>
          <h2>
            <code>VideoWorkerGlobalScope</code> interface
          </h2>
          <dl class="idl" title="interface VideoWorkerGlobalScope : WorkerGlobalScope ">
            <dt>
              [Throws]
              void postMessage(any message, optional sequence&lt;any&gt; transfer)
            </dt>
            <dd>
              -
            </dd>
            <dt>
              [TreatNonCallableAsNull] attribute Function? onvideoprocess
            </dt>
            <dd>
              -
            </dd>
            <dt>
              [TreatNonCallableAsNull] attribute Function? onmessage
            </dt>
            <dd>
              -
            </dd>
          </dl>
        </section>
        <section>
          <h2>
            <code>VideoProcessEvent</code> interface
          </h2>
          <dl class="idl" title="interface VideoProcessEvent : Event">
            <dt>
              readonly attribute DOMString trackId
            </dt>
            <dd>
              -
            </dd>
            <dt>
              readonly attribute double playbackTime
            </dt>
            <dd>
              -
            </dd>
            <dt>
              readonly attribute ImageBitmap inputImageBitmap
            </dt>
            <dd>
              -
            </dd>
            <dt>
              readonly attribute ImageBitmap? outputImageBitmap
            </dt>
            <dd>
              -
            </dd>
          </dl>
        </section>
        <section>
          <h2>
            <code>VideoWorker</code> interface
          </h2>
          <dl class="idl" title="[Constructor(DOMString scriptURL)] interface VideoWorker : Worker">
            <dt>
              [TreatNonCallableAsNull] attribute Function? onmessage
            </dt>
            <dd>
              -
            </dd>
          </dl>
        </section>
        <section>
          <h2>
            <code>MediaStreamTrack</code> interface
          </h2>
          <dl class="idl" title="partial interface MediaStreamTrack">
            <dt>
              void addWorkerMonitor(VideoWorker worker)
            </dt>
            <dd>
              -
            </dd>
            <dt>
              void removeWorkerMonitor(VideoWorker worker)
            </dt>
            <dd>
              -
            </dd>
            <dt>
              MediaStreamTrack addWorkerProcessor(VideoWorker worker)
            </dt>
            <dd>
              -
            </dd>
            <dt>
              void removeWorkerProcessor()
            </dt>
            <dd>
              -
            </dd>
          </dl>
        </section>
    </section>
    <section>
      <h2>Examples</h2>
      <p>
        Under Construction...
      </p>
    </section>

    <section class='appendix'>
      <h2>Acknowledgements</h2>
      <p>
        Thanks to Robert O'Callahan for his idea for the design.
      </p>
    </section>
  </body>
</html>
